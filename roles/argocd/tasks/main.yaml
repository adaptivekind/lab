- copy:
    src: helm.gpg
    dest: /usr/share/keyrings/helm.gpg

- name: Add Docker apt repository
  apt_repository:
    repo: deb [arch=arm64 signed-by=/usr/share/keyrings/helm.gpg] https://baltocdn.com/helm/stable/debian/ all main
    state: present
    update_cache: yes

- name: Install helm
  apt:
    name: helm

- name: Add ArgoCD repository
  shell: helm repo add argo https://argoproj.github.io/argo-helm

- name: Add ArgoCD repository
  shell: helm repo update

- name: Deploy ArgoCD
  shell: helm install argocd argo/argo-cd --namespace argocd --create-namespace
